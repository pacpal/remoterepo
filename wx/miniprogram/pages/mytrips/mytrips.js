"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const profile_1 = require("../../service/profile");
const rental_pb_1 = require("../../service/proto_gen/rental/rental_pb");
const trip_1 = require("../../service/trip");
const format_1 = require("../../utils/format");
const routing_1 = require("../../utils/routing");
const tripStatusMap = new Map([
    [rental_pb_1.rental.v1.TripStatus.IN_PROGRESS, '进行中'],
    [rental_pb_1.rental.v1.TripStatus.FINISHED, '已完成'],
]);
const licStatusMap = new Map([
    [rental_pb_1.rental.v1.IdentityStatus.UNSUBMITTED, '未认证'],
    [rental_pb_1.rental.v1.IdentityStatus.PENDING, '未认证'],
    [rental_pb_1.rental.v1.IdentityStatus.VERIFIED, '已认证'],
]);
Page({
    scrollStates: {
        mainItems: [],
    },
    layoutResolver: undefined,
    data: {
        promotionItems: [
            {
                img: 'https://img.mukewang.com/5f7301d80001fdee18720764.jpg',
                promotionID: 1,
            },
            {
                img: 'https://img.mukewang.com/5f6805710001326c18720764.jpg',
                promotionID: 2,
            },
            {
                img: 'https://img.mukewang.com/5f6173b400013d4718720764.jpg',
                promotionID: 3,
            },
            {
                img: 'https://img.mukewang.com/5f7141ad0001b36418720764.jpg',
                promotionID: 4,
            },
        ],
        licStatus: licStatusMap.get(rental_pb_1.rental.v1.IdentityStatus.UNSUBMITTED),
        avatarURL: '',
        tripsHeight: 0,
        navCount: 0,
        mainItems: [],
        mainScroll: '',
        navItems: [],
        navSel: '',
        navScroll: '',
    },
    onLoad() {
        const layoutReady = new Promise((resolve) => {
            this.layoutResolver = resolve;
        });
        Promise.all([trip_1.TripService.getTrips(), layoutReady]).then(([trips]) => {
            this.populateTrips(trips.trips);
        });
        getApp().globalData.userInfo.then(userInfo => {
            this.setData({
                avatarURL: userInfo.avatarUrl,
            });
        });
    },
    onShow() {
        profile_1.ProfileService.getProfile().then(p => {
            this.setData({
                licStatus: licStatusMap.get(p.identityStatus || 0),
            });
        });
    },
    onReady() {
        wx.createSelectorQuery().select('#heading')
            .boundingClientRect(rect => {
            const height = wx.getSystemInfoSync().windowHeight - rect.height;
            this.setData({
                tripsHeight: height,
                navCount: Math.round(height / 50),
            }, () => {
                if (this.layoutResolver) {
                    this.layoutResolver();
                }
            });
        }).exec();
    },
    populateTrips(trips) {
        var _a, _b, _c, _d, _e, _f, _g, _h, _j;
        const mainItems = [];
        const navItems = [];
        let navSel = '';
        let prevNav = '';
        for (let i = 0; i < trips.length; i++) {
            const trip = trips[i];
            const mainId = 'main-' + i;
            const navId = 'nav-' + i;
            const shortId = (_a = trip.id) === null || _a === void 0 ? void 0 : _a.substr(trip.id.length - 6);
            if (!prevNav) {
                prevNav = navId;
            }
            const tripData = {
                id: trip.id,
                shortId: '****' + shortId,
                start: ((_c = (_b = trip.trip) === null || _b === void 0 ? void 0 : _b.start) === null || _c === void 0 ? void 0 : _c.poiName) || '未知',
                end: '',
                distance: '',
                duration: '',
                fee: '',
                status: tripStatusMap.get((_d = trip.trip) === null || _d === void 0 ? void 0 : _d.status) || '未知',
                inProgress: ((_e = trip.trip) === null || _e === void 0 ? void 0 : _e.status) === rental_pb_1.rental.v1.TripStatus.IN_PROGRESS,
            };
            const end = (_f = trip.trip) === null || _f === void 0 ? void 0 : _f.end;
            if (end) {
                tripData.end = end.poiName || '未知',
                    tripData.distance = ((_g = end.kmDriven) === null || _g === void 0 ? void 0 : _g.toFixed(1)) + '公里',
                    tripData.fee = format_1.formatFee(end.feeCent || 0);
                const dur = format_1.formatDuration((end.timestampSec || 0) - (((_j = (_h = trip.trip) === null || _h === void 0 ? void 0 : _h.start) === null || _j === void 0 ? void 0 : _j.timestampSec) || 0));
                tripData.duration = `${dur.hh}时${dur.mm}分`;
            }
            mainItems.push({
                id: mainId,
                navId: navId,
                navScrollId: prevNav,
                data: tripData,
            });
            navItems.push({
                id: navId,
                mainId: mainId,
                label: shortId || '',
            });
            if (i === 0) {
                navSel = navId;
            }
            prevNav = navId;
        }
        for (let i = 0; i < this.data.navCount - 1; i++) {
            navItems.push({
                id: '',
                mainId: '',
                label: '',
            });
        }
        this.setData({
            mainItems,
            navItems,
            navSel,
        }, () => {
            this.prepareScrollStates();
        });
    },
    prepareScrollStates() {
        wx.createSelectorQuery().selectAll('.main-item')
            .fields({
            id: true,
            dataset: true,
            rect: true,
        }).exec(res => {
            this.scrollStates.mainItems = res[0];
        });
    },
    onPromotionItemTap(e) {
        const promotionID = e.currentTarget.dataset.promotionId;
        if (promotionID) {
            console.log('claiming promotion', promotionID);
        }
    },
    onGetUserInfo(e) {
        const userInfo = e.detail.userInfo;
        if (userInfo) {
            getApp().resolveUserInfo(userInfo);
            this.setData({
                avatarURL: userInfo.avatarUrl,
            });
        }
    },
    onRegisterTap() {
        wx.navigateTo({
            url: routing_1.routing.register(),
        });
    },
    onNavItemTap(e) {
        var _a, _b, _c;
        const mainId = (_b = (_a = e.currentTarget) === null || _a === void 0 ? void 0 : _a.dataset) === null || _b === void 0 ? void 0 : _b.mainId;
        const navId = (_c = e.currentTarget) === null || _c === void 0 ? void 0 : _c.id;
        if (mainId && navId) {
            this.setData({
                mainScroll: mainId,
                navSel: navId,
            });
        }
    },
    onMainScroll(e) {
        var _a, _b;
        const top = ((_a = e.currentTarget) === null || _a === void 0 ? void 0 : _a.offsetTop) + ((_b = e.detail) === null || _b === void 0 ? void 0 : _b.scrollTop);
        if (top === undefined) {
            return;
        }
        const selItem = this.scrollStates.mainItems.find(v => v.top >= top);
        if (!selItem) {
            return;
        }
        this.setData({
            navSel: selItem.dataset.navId,
            navScroll: selItem.dataset.navScrollId,
        });
    },
    onMianItemTap(e) {
        if (!e.currentTarget.dataset.tripInProgress) {
            return;
        }
        const tripId = e.currentTarget.dataset.tripId;
        if (tripId) {
            wx.redirectTo({
                url: routing_1.routing.drving({
                    trip_id: tripId,
                }),
            });
        }
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibXl0cmlwcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIm15dHJpcHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFDQSxtREFBc0Q7QUFDdEQsd0VBQWlFO0FBQ2pFLDZDQUFnRDtBQUNoRCwrQ0FBOEQ7QUFDOUQsaURBQTZDO0FBb0M3QyxNQUFNLGFBQWEsR0FBRyxJQUFJLEdBQUcsQ0FBQztJQUMxQixDQUFDLGtCQUFNLENBQUMsRUFBRSxDQUFDLFVBQVUsQ0FBQyxXQUFXLEVBQUUsS0FBSyxDQUFDO0lBQ3pDLENBQUMsa0JBQU0sQ0FBQyxFQUFFLENBQUMsVUFBVSxDQUFDLFFBQVEsRUFBRSxLQUFLLENBQUM7Q0FDekMsQ0FBQyxDQUFBO0FBRUYsTUFBTSxZQUFZLEdBQUcsSUFBSSxHQUFHLENBQUM7SUFDekIsQ0FBQyxrQkFBTSxDQUFDLEVBQUUsQ0FBQyxjQUFjLENBQUMsV0FBVyxFQUFFLEtBQUssQ0FBQztJQUM3QyxDQUFDLGtCQUFNLENBQUMsRUFBRSxDQUFDLGNBQWMsQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDO0lBQ3pDLENBQUMsa0JBQU0sQ0FBQyxFQUFFLENBQUMsY0FBYyxDQUFDLFFBQVEsRUFBRSxLQUFLLENBQUM7Q0FDN0MsQ0FBQyxDQUFBO0FBRUYsSUFBSSxDQUFDO0lBQ0QsWUFBWSxFQUFFO1FBQ1YsU0FBUyxFQUFFLEVBQTJCO0tBQ3pDO0lBRUQsY0FBYyxFQUFFLFNBQWlDO0lBRWpELElBQUksRUFBRTtRQUNGLGNBQWMsRUFBRTtZQUNaO2dCQUNJLEdBQUcsRUFBRSx1REFBdUQ7Z0JBQzVELFdBQVcsRUFBRSxDQUFDO2FBQ2pCO1lBQ0Q7Z0JBQ0ksR0FBRyxFQUFFLHVEQUF1RDtnQkFDNUQsV0FBVyxFQUFFLENBQUM7YUFDakI7WUFDRDtnQkFDSSxHQUFHLEVBQUUsdURBQXVEO2dCQUM1RCxXQUFXLEVBQUUsQ0FBQzthQUNqQjtZQUNEO2dCQUNJLEdBQUcsRUFBRSx1REFBdUQ7Z0JBQzVELFdBQVcsRUFBRSxD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QUFBO1NBQ0w7SUFDTCxDQUFDO0lBRUQsWUFBWSxDQUFDLENBQU07O1FBQ2YsTUFBTSxHQUFHLEdBQVcsT0FBQSxDQUFDLENBQUMsYUFBYSwwQ0FBRSxTQUFTLFdBQUcsQ0FBQyxDQUFDLE1BQU0sMENBQUUsU0FBUyxDQUFBLENBQUE7UUFDcEUsSUFBSSxHQUFHLEtBQUssU0FBUyxFQUFFO1lBQ25CLE9BQU07U0FDVDtRQUVELE1BQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsU0FBUyxDQUFDLElBQUksQ0FDNUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLEdBQUcsQ0FBQyxDQUFBO1FBQ3RCLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDVixPQUFNO1NBQ1Q7UUFFRCxJQUFJLENBQUMsT0FBTyxDQUFDO1lBQ1QsTUFBTSxFQUFFLE9BQU8sQ0FBQyxPQUFPLENBQUMsS0FBSztZQUM3QixTQUFTLEVBQUUsT0FBTyxDQUFDLE9BQU8sQ0FBQyxXQUFXO1NBQ3pDLENBQUMsQ0FBQTtJQUNOLENBQUM7SUFFRCxhQUFhLENBQUMsQ0FBTTtRQUNoQixJQUFJLENBQUMsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxPQUFPLENBQUMsY0FBYyxFQUFFO1lBQ3pDLE9BQU07U0FDVDtRQUNELE1BQU0sTUFBTSxHQUFHLENBQUMsQ0FBQyxhQUFhLENBQUMsT0FBTyxDQUFDLE1BQU0sQ0FBQTtRQUM3QyxJQUFJLE1BQU0sRUFBRTtZQUNSLEVBQUUsQ0FBQyxVQUFVLENBQUM7Z0JBQ1YsR0FBRyxFQUFFLGlCQUFPLENBQUMsTUFBTSxDQUFDO29CQUNoQixPQUFPLEVBQUUsTUFBTTtpQkFDbEIsQ0FBQzthQUNMLENBQUMsQ0FBQTtTQUNMO0lBQ0wsQ0FBQztDQUNKLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElBcHBPcHRpb24gfSBmcm9tIFwiLi4vLi4vYXBwb3B0aW9uXCJcbmltcG9ydCB7IFByb2ZpbGVTZXJ2aWNlIH0gZnJvbSBcIi4uLy4uL3NlcnZpY2UvcHJvZmlsZVwiXG5pbXBvcnQgeyByZW50YWwgfSBmcm9tIFwiLi4vLi4vc2VydmljZS9wcm90b19nZW4vcmVudGFsL3JlbnRhbF9wYlwiXG5pbXBvcnQgeyBUcmlwU2VydmljZSB9IGZyb20gXCIuLi8uLi9zZXJ2aWNlL3RyaXBcIlxuaW1wb3J0IHsgZm9ybWF0RHVyYXRpb24sIGZvcm1hdEZlZSB9IGZyb20gXCIuLi8uLi91dGlscy9mb3JtYXRcIlxuaW1wb3J0IHsgcm91dGluZyB9IGZyb20gXCIuLi8uLi91dGlscy9yb3V0aW5nXCJcblxuaW50ZXJmYWNlIFRyaXAge1xuICAgIGlkOiBzdHJpbmdcbiAgICBzaG9ydElkOiBzdHJpbmdcbiAgICBzdGFydDogc3RyaW5nXG4gICAgZW5kOiBzdHJpbmdcbiAgICBkdXJhdGlvbjogc3RyaW5nXG4gICAgZmVlOiBzdHJpbmdcbiAgICBkaXN0YW5jZTogc3RyaW5nXG4gICAgc3RhdHVzOiBzdHJpbmdcbiAgICBpblByb2dyZXNzOiBib29sZWFuXG59XG5cbmludGVyZmFjZSBNYWluSXRlbSB7XG4gICAgaWQ6IHN0cmluZ1xuICAgIG5hdklkOiBzdHJpbmdcbiAgICBuYXZTY3JvbGxJZDogc3RyaW5nXG4gICAgZGF0YTogVHJpcFxufVxuXG5pbnRlcmZhY2UgTmF2SXRlbSB7XG4gICAgaWQ6IHN0cmluZ1xuICAgIG1haW5JZDogc3RyaW5nXG4gICAgbGFiZWw6IHN0cmluZ1xufVxuXG5pbnRlcmZhY2UgTWFpbkl0ZW1RdWVyeVJlc3VsdCB7XG4gICAgaWQ6IHN0cmluZ1xuICAgIHRvcDogbnVtYmVyXG4gICAgZGF0YXNldDoge1xuICAgICAgICBuYXZJZDogc3RyaW5nXG4gICAgICAgIG5hdlNjcm9sbElkOiBzdHJpbmdcbiAgICB9XG59XG5cbmNvbnN0IHRyaXBTdGF0dXNNYXAgPSBuZXcgTWFwKFtcbiAgICBbcmVudGFsLnYxLlRyaXBTdGF0dXMuSU5fUFJPR1JFU1MsICfov5vooYzkuK0nXSxcbiAgICBbcmVudGFsLnYxLlRyaXBTdGF0dXMuRklOSVNIRUQsICflt7LlrozmiJAnXSxcbl0pXG5cbmNvbnN0IGxpY1N0YXR1c01hcCA9IG5ldyBNYXAoW1xuICAgIFtyZW50YWwudjEuSWRlbnRpdHlTdGF0dXMuVU5TVUJNSVRURUQsICfmnKrorqTor4EnXSxcbiAgICBbcmVudGFsLnYxLklkZW50aXR5U3RhdHVzLlBFTkRJTkcsICfmnKrorqTor4EnXSxcbiAgICBbcmVudGFsLnYxLklkZW50aXR5U3RhdHVzLlZFUklGSUVELCAn5bey6K6k6K+BJ10sXG5dKVxuXG5QYWdlKHtcbiAgICBzY3JvbGxTdGF0ZXM6IHtcbiAgICAgICAgbWFpbkl0ZW1zOiBbXSBhcyBNYWluSXRlbVF1ZXJ5UmVzdWx0W10sXG4gICAgfSxcblxuICAgIGxheW91dFJlc29sdmVyOiB1bmRlZmluZWQgYXMgKCgpPT52b2lkKXx1bmRlZmluZWQsXG5cbiAgICBkYXRhOiB7XG4gICAgICAgIHByb21vdGlvbkl0ZW1zOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaW1nOiAnaHR0cHM6Ly9pbWcubXVrZXdhbmcuY29tLzVmNzMwMWQ4MDAwMWZkZWUxODcyMDc2NC5qcGcnLFxuICAgICAgICAgICAgICAgIHByb21vdGlvbklEOiAxLFxuICAgICAgICAgICAgfSwgICAgICAgICAgICBcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpbWc6ICdodHRwczovL2ltZy5tdWtld2FuZy5jb20vNWY2ODA1NzEwMDAxMzI2YzE4NzIwNzY0LmpwZycsXG4gICAgICAgICAgICAgICAgcHJvbW90aW9uSUQ6IDIsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGltZzogJ2h0dHBzOi8vaW1nLm11a2V3YW5nLmNvbS81ZjYxNzNiNDAwMDEzZDQ3MTg3MjA3NjQuanBnJyxcbiAgICAgICAgICAgICAgICBwcm9tb3Rpb25JRDogMyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaW1nOiAnaHR0cHM6Ly9pbWcubXVrZXdhbmcuY29tLzVmNzE0MWFkMDAwMWIzNjQxODcyMDc2NC5qcGcnLFxuICAgICAgICAgICAgICAgIHByb21vdGlvbklEOiA0LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgXSxcbiAgICAgICAgbGljU3RhdHVzOiBsaWNTdGF0dXNNYXAuZ2V0KHJlbnRhbC52MS5JZGVudGl0eVN0YXR1cy5VTlNVQk1JVFRFRCksXG4gICAgICAgIGF2YXRhclVSTDogJycsXG4gICAgICAgIHRyaXBzSGVpZ2h0OiAwLFxuICAgICAgICBuYXZDb3VudDogMCxcbiAgICAgICAgbWFpbkl0ZW1zOiBbXSBhcyBNYWluSXRlbVtdLFxuICAgICAgICBtYWluU2Nyb2xsOiAnJyxcbiAgICAgICAgbmF2SXRlbXM6IFtdIGFzIE5hdkl0ZW1bXSxcbiAgICAgICAgbmF2U2VsOiAnJyxcbiAgICAgICAgbmF2U2Nyb2xsOiAnJyxcbiAgICB9LFxuXG4gICAgb25Mb2FkKCkge1xuICAgICAgICBjb25zdCBsYXlvdXRSZWFkeSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmxheW91dFJlc29sdmVyID0gcmVzb2x2ZVxuICAgICAgICB9KVxuICAgICAgICBQcm9taXNlLmFsbChbVHJpcFNlcnZpY2UuZ2V0VHJpcHMoKSwgbGF5b3V0UmVhZHldKS50aGVuKChbdHJpcHNdKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBvcHVsYXRlVHJpcHModHJpcHMudHJpcHMhKVxuICAgICAgICB9KVxuICAgICAgICBnZXRBcHA8SUFwcE9wdGlvbj4oKS5nbG9iYWxEYXRhLnVzZXJJbmZvLnRoZW4odXNlckluZm8gPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgICAgICAgICBhdmF0YXJVUkw6IHVzZXJJbmZvLmF2YXRhclVybCxcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfSxcblxuICAgIG9uU2hvdygpIHtcbiAgICAgICAgUHJvZmlsZVNlcnZpY2UuZ2V0UHJvZmlsZSgpLnRoZW4ocCA9PiB7XG4gICAgICAgICAgICB0aGlzLnNldERhdGEoe1xuICAgICAgICAgICAgICAgIGxpY1N0YXR1czogbGljU3RhdHVzTWFwLmdldChwLmlkZW50aXR5U3RhdHVzfHwwKSxcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfSxcblxuICAgIG9uUmVhZHkoKSB7XG4gICAgICAgIHd4LmNyZWF0ZVNlbGVjdG9yUXVlcnkoKS5zZWxlY3QoJyNoZWFkaW5nJylcbiAgICAgICAgICAgIC5ib3VuZGluZ0NsaWVudFJlY3QocmVjdCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaGVpZ2h0ID0gd3guZ2V0U3lzdGVtSW5mb1N5bmMoKS53aW5kb3dIZWlnaHQgLSByZWN0LmhlaWdodFxuICAgICAgICAgICAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgICAgICAgICAgICAgIHRyaXBzSGVpZ2h0OiBoZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgIG5hdkNvdW50OiBNYXRoLnJvdW5kKGhlaWdodC81MCksXG4gICAgICAgICAgICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5sYXlvdXRSZXNvbHZlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sYXlvdXRSZXNvbHZlcigpXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSkuZXhlYygpXG4gICAgfSxcblxuICAgIHBvcHVsYXRlVHJpcHModHJpcHM6IHJlbnRhbC52MS5JVHJpcEVudGl0eVtdKSB7XG4gICAgICAgIGNvbnN0IG1haW5JdGVtczogTWFpbkl0ZW1bXSA9IFtdXG4gICAgICAgIGNvbnN0IG5hdkl0ZW1zOiBOYXZJdGVtW10gPSBbXVxuICAgICAgICBsZXQgbmF2U2VsID0gJydcbiAgICAgICAgbGV0IHByZXZOYXYgPSAnJ1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRyaXBzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCB0cmlwID0gdHJpcHNbaV1cbiAgICAgICAgICAgIGNvbnN0IG1haW5JZCA9ICdtYWluLScgKyBpXG4gICAgICAgICAgICBjb25zdCBuYXZJZCA9ICduYXYtJyArIGlcbiAgICAgICAgICAgIGNvbnN0IHNob3J0SWQgPSB0cmlwLmlkPy5zdWJzdHIodHJpcC5pZC5sZW5ndGgtNilcbiAgICAgICAgICAgIGlmICghcHJldk5hdikge1xuICAgICAgICAgICAgICAgIHByZXZOYXYgPSBuYXZJZFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgdHJpcERhdGE6IFRyaXAgPSB7XG4gICAgICAgICAgICAgICAgaWQ6IHRyaXAuaWQhLFxuICAgICAgICAgICAgICAgIHNob3J0SWQ6ICcqKioqJytzaG9ydElkLFxuICAgICAgICAgICAgICAgIHN0YXJ0OiB0cmlwLnRyaXA/LnN0YXJ0Py5wb2lOYW1lfHwn5pyq55+lJyxcbiAgICAgICAgICAgICAgICBlbmQ6ICcnLFxuICAgICAgICAgICAgICAgIGRpc3RhbmNlOiAnJyxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogJycsXG4gICAgICAgICAgICAgICAgZmVlOiAnJyxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IHRyaXBTdGF0dXNNYXAuZ2V0KHRyaXAudHJpcD8uc3RhdHVzISl8fCfmnKrnn6UnLFxuICAgICAgICAgICAgICAgIGluUHJvZ3Jlc3M6IHRyaXAudHJpcD8uc3RhdHVzID09PSAgcmVudGFsLnYxLlRyaXBTdGF0dXMuSU5fUFJPR1JFU1MsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBlbmQgPSB0cmlwLnRyaXA/LmVuZFxuICAgICAgICAgICAgaWYgKGVuZCkge1xuICAgICAgICAgICAgICAgIHRyaXBEYXRhLmVuZCA9IGVuZC5wb2lOYW1lfHwn5pyq55+lJyxcbiAgICAgICAgICAgICAgICB0cmlwRGF0YS5kaXN0YW5jZSA9IGVuZC5rbURyaXZlbj8udG9GaXhlZCgxKSsn5YWs6YeMJyxcbiAgICAgICAgICAgICAgICB0cmlwRGF0YS5mZWUgPSBmb3JtYXRGZWUoZW5kLmZlZUNlbnR8fDApXG4gICAgICAgICAgICAgICAgY29uc3QgZHVyID0gZm9ybWF0RHVyYXRpb24oKGVuZC50aW1lc3RhbXBTZWN8fDApIC0gKHRyaXAudHJpcD8uc3RhcnQ/LnRpbWVzdGFtcFNlY3x8MCkpXG4gICAgICAgICAgICAgICAgdHJpcERhdGEuZHVyYXRpb24gPSBgJHtkdXIuaGh95pe2JHtkdXIubW195YiGYFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWFpbkl0ZW1zLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBtYWluSWQsXG4gICAgICAgICAgICAgICAgbmF2SWQ6IG5hdklkLFxuICAgICAgICAgICAgICAgIG5hdlNjcm9sbElkOiBwcmV2TmF2LFxuICAgICAgICAgICAgICAgIGRhdGE6IHRyaXBEYXRhLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIG5hdkl0ZW1zLnB1c2goe1xuICAgICAgICAgICAgICAgIGlkOiBuYXZJZCxcbiAgICAgICAgICAgICAgICBtYWluSWQ6IG1haW5JZCxcbiAgICAgICAgICAgICAgICBsYWJlbDogc2hvcnRJZHx8JycsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgaWYgKGkgPT09IDApIHtcbiAgICAgICAgICAgICAgICBuYXZTZWwgPSBuYXZJZFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcHJldk5hdiA9IG5hdklkXG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRhdGEubmF2Q291bnQtMTsgaSsrKSB7XG4gICAgICAgICAgICBuYXZJdGVtcy5wdXNoKHtcbiAgICAgICAgICAgICAgICBpZDogJycsXG4gICAgICAgICAgICAgICAgbWFpbklkOiAnJyxcbiAgICAgICAgICAgICAgICBsYWJlbDogJycsXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgICAgICBtYWluSXRlbXMsXG4gICAgICAgICAgICBuYXZJdGVtcyxcbiAgICAgICAgICAgIG5hdlNlbCxcbiAgICAgICAgfSwgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcmVwYXJlU2Nyb2xsU3RhdGVzKClcbiAgICAgICAgfSlcbiAgICB9LFxuXG4gICAgcHJlcGFyZVNjcm9sbFN0YXRlcygpIHtcbiAgICAgICAgd3guY3JlYXRlU2VsZWN0b3JRdWVyeSgpLnNlbGVjdEFsbCgnLm1haW4taXRlbScpXG4gICAgICAgICAgICAuZmllbGRzKHtcbiAgICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBkYXRhc2V0OiB0cnVlLFxuICAgICAgICAgICAgICAgIHJlY3Q6IHRydWUsXG4gICAgICAgICAgICB9KS5leGVjKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zY3JvbGxTdGF0ZXMubWFpbkl0ZW1zID0gcmVzWzBdXG4gICAgICAgICAgICB9KVxuICAgIH0sXG5cbiAgICBvblByb21vdGlvbkl0ZW1UYXAoZTogYW55KSB7XG4gICAgICAgIGNvbnN0IHByb21vdGlvbklEOm51bWJlciA9IGUuY3VycmVudFRhcmdldC5kYXRhc2V0LnByb21vdGlvbklkXG4gICAgICAgIGlmIChwcm9tb3Rpb25JRCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2NsYWltaW5nIHByb21vdGlvbicsIHByb21vdGlvbklEKVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uR2V0VXNlckluZm8oZTogYW55KSB7XG4gICAgICAgIGNvbnN0IHVzZXJJbmZvOiBXZWNoYXRNaW5pcHJvZ3JhbS5Vc2VySW5mbyA9IGUuZGV0YWlsLnVzZXJJbmZvXG4gICAgICAgIGlmICh1c2VySW5mbykge1xuICAgICAgICAgICAgZ2V0QXBwPElBcHBPcHRpb24+KCkucmVzb2x2ZVVzZXJJbmZvKHVzZXJJbmZvKVxuICAgICAgICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgICAgICAgICBhdmF0YXJVUkw6IHVzZXJJbmZvLmF2YXRhclVybCxcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICB9LFxuXG4gICAgb25SZWdpc3RlclRhcCgpIHtcbiAgICAgICAgd3gubmF2aWdhdGVUbyh7XG4gICAgICAgICAgICB1cmw6IHJvdXRpbmcucmVnaXN0ZXIoKSxcbiAgICAgICAgfSlcbiAgICB9LFxuXG4gICAgb25OYXZJdGVtVGFwKGU6IGFueSkge1xuICAgICAgICBjb25zdCBtYWluSWQ6IHN0cmluZyA9IGUuY3VycmVudFRhcmdldD8uZGF0YXNldD8ubWFpbklkXG4gICAgICAgIGNvbnN0IG5hdklkOiBzdHJpbmcgPSBlLmN1cnJlbnRUYXJnZXQ/LmlkXG4gICAgICAgIGlmIChtYWluSWQgJiYgbmF2SWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0RGF0YSh7XG4gICAgICAgICAgICAgICAgbWFpblNjcm9sbDogbWFpbklkLFxuICAgICAgICAgICAgICAgIG5hdlNlbDogbmF2SWQsXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uTWFpblNjcm9sbChlOiBhbnkpIHtcbiAgICAgICAgY29uc3QgdG9wOiBudW1iZXIgPSBlLmN1cnJlbnRUYXJnZXQ/Lm9mZnNldFRvcCArIGUuZGV0YWlsPy5zY3JvbGxUb3BcbiAgICAgICAgaWYgKHRvcCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHNlbEl0ZW0gPSB0aGlzLnNjcm9sbFN0YXRlcy5tYWluSXRlbXMuZmluZChcbiAgICAgICAgICAgIHYgPT4gdi50b3AgPj0gdG9wKVxuICAgICAgICBpZiAoIXNlbEl0ZW0pIHtcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5zZXREYXRhKHtcbiAgICAgICAgICAgIG5hdlNlbDogc2VsSXRlbS5kYXRhc2V0Lm5hdklkLFxuICAgICAgICAgICAgbmF2U2Nyb2xsOiBzZWxJdGVtLmRhdGFzZXQubmF2U2Nyb2xsSWQsXG4gICAgICAgIH0pXG4gICAgfSxcblxuICAgIG9uTWlhbkl0ZW1UYXAoZTogYW55KSB7XG4gICAgICAgIGlmICghZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQudHJpcEluUHJvZ3Jlc3MpIHtcbiAgICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHRyaXBJZCA9IGUuY3VycmVudFRhcmdldC5kYXRhc2V0LnRyaXBJZFxuICAgICAgICBpZiAodHJpcElkKSB7XG4gICAgICAgICAgICB3eC5yZWRpcmVjdFRvKHtcbiAgICAgICAgICAgICAgICB1cmw6IHJvdXRpbmcuZHJ2aW5nKHtcbiAgICAgICAgICAgICAgICAgICAgdHJpcF9pZDogdHJpcElkLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cbn0pXG4iXX0=